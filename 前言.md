# fastai与PyTorch深度学习实践指南

### 关于本书的赞誉

> 若你正寻找一本从基础入门、引领你直抵研究前沿的指南，此书正是你的不二之选。别让那些博士们独占鳌头——你同样能运用深度学习解决实际问题。
>
> ——Hal Varian,，加州大学伯克利分校名誉教授；谷歌首席经济学家

> 随着人工智能迈入深度学习时代，我们所有人都应尽可能深入了解其运作机制。《深度学习实践指南》为初学者提供了绝佳的入门途径，它成功将多数人视为高度复杂的领域化繁为简。
>
> ——Eric Topol，《深度医疗》作者；斯克里普斯研究所教授

> 杰里米和西尔万将带你踏上一段互动之旅——字面意义上的互动，因为每行代码都可在笔记本中运行——带你穿越深度学习的损失谷与性能峰。本书穿插着多年开发和教授机器学习积累的深刻轶事与实用洞见，以轻松对话的方式阐释深奥技术概念，实现了难得的平衡。本书忠实传承fast.ai屡获殊荣的在线教学理念，为你提供前沿实用工具及真实案例进行实践演练。无论你是初学者还是资深从业者，本书都将助你加速深学习之旅，引领你抵达新的高峰——乃至新的深度。
>
> ——Sebastian Ruder，Deepmind研究科学家

> 杰里米·霍华德与西尔万·古格合著的这部杰作，成功地将人工智能领域与现实世界紧密相连。本书以独特而深刻的洞见，为所有对深度学习感兴趣的读者提供了一本既扎实又通俗易懂的入门指南，堪称该领域众多著作中的指路明灯。
>
> ——Anthony Chang，橙县儿童医院首席智能与创新官

> 如何快速掌握深度学习精髓而不陷入泥潭？如何通过实例与代码快速领悟核心概念、技术要领与行业诀窍？答案就在这里。切勿错过深度学习实践的新经典指南。
>
> ——Oren Etzioni，华盛顿大学教授、艾伦人工智能研究所首席执行官

> 这本书是难得的瑰宝——凝聚了精心设计且极具成效的教学智慧，历经数年反复打磨，造就了数千名满意学员。我便是其中之一。fast.ai以美妙的方式改变了我的生活，我坚信它也能为你带来同样的改变。
>
> ——Jason Antic，《DeOldify》创始人

> 《深度学习实践指南》是一本不可多得的资源。本书开篇即直奔主题，前几章便传授深度学习的有效应用方法。随后以深入浅出的方式全面剖析机器学习模型与框架的内部运作机制，助你透彻理解并在此基础上进行拓展。真希望当初学习机器学习时就有这样的书，堪称经典之作！
>
> ——Emmanuel Ameisen，《构建机器学习驱动的应用程序》作者

> 正如本书第一章第一节所述，“深度学习人人可学”。尽管其他书籍可能提出类似主张，但本书真正践行了这一承诺。作者们虽具备该领域的深厚造诣，却能以完美契合编程背景但缺乏机器学习经验的读者视角进行阐述。本书坚持先展示实例，仅在具体案例中穿插理论讲解。对多数人而言，这正是最佳学习路径。书中不仅全面覆盖了计算机视觉、自然语言处理和表格数据处理等深度学习核心应用领域，更涵盖了其他著作常忽略的数据伦理等关键议题。总而言之，这是程序员精通深度学习的最佳资源之一。
>
> ——Peter Norvig，谷歌研究总监

> 古格和霍华德为所有接触过编程的人打造了一本理想的资源。本书及其配套的fast.ai课程采用实践导向，通过预先编写的可探索复用的代码，以简明实用的方式揭开深度学习的神秘面纱。告别枯燥的理论证明与抽象概念。第一章你将亲手构建首个深度学习模型，读完本书时，你将掌握解读任何深度学习论文方法论章节的核心能力。
>
> ——Curtis Langlotz，斯坦福大学医学与影像人工智能中心主任

> 本书揭开了最神秘的黑匣子——深度学习的神秘面纱。它提供完整的Python笔记本，支持快速代码实验。同时深入探讨人工智能的伦理影响，并展示如何避免其演变为反乌托邦。
>
> ——Guillaume Chaslot，Mozilla研究员

> 作为一名从钢琴家转型为OpenAI研究员的人，我常被问及如何入门深度学习，而我总是推荐《深度学习实践指南》。这本书实现了看似不可能的任务——它既是复杂主题的友好指南，又充满尖端知识，连资深从业者也会爱不释手。
>
> ——Christine Payne，OpenAI研究员

> 一本极具实践性且通俗易懂的书籍，助您快速开启深度学习项目。本书以清晰易懂的方式，诚恳地指引读者踏上深度学习实践之路。无论初学者还是高管都能从中获益。这正是我多年前梦寐以求的指南！
>
> ——Carol Reiley，Drive.ai 创始人兼董事长

> 杰里米和西尔万在深度学习领域的专长、他们对机器学习的务实态度，以及众多宝贵的开源贡献，使他们成为PyTorch社区的核心人物。本书延续了他们与fast.ai社区推动机器学习普及的工作，必将为整个人工智能领域带来巨大裨益。
>
> ——Jerome Pesenti，Facebook人工智能副总裁

> 深度学习是当今最重要的技术之一，它推动了人工智能领域诸多惊人的近期突破。它曾是博士专属领域，如今已非如此！本书基于广受欢迎的fast.ai课程，使任何具备编程经验的人都能掌握深度学习。本书涵盖完整体系，配有精彩的实践案例及配套互动网站。即便是博士学者也能从中获益良多。
>
> ——Gregory Piatetsky-Shapiro，KDnuggets总裁 

> 作为我多年来持续推荐的fast.ai课程的延伸，这本由杰里米和西尔万合著的书籍——两位当今顶尖的深度学习专家——将在短短数月内助你从初学者蜕变为合格的从业者。终于，2020年也涌现出些积极的成果！
>
> ——Louis Monier，Altavista创始人；前爱彼迎人工智能实验室负责人

> 我们推荐这本书！《深度学习实践指南》运用先进框架，快速推进具体的人工智能或自动化任务实践。这为探讨通常被忽视的主题留出空间，例如安全部署模型至生产环境，以及亟需的数据伦理章节。
>
> ——John Mount 和 Nina Zumel，《R语言实用数据科学》作者

> 本书是“为程序员而写”，无需博士学位。我本人拥有博士学位却非程序员，为何受邀撰写书评？只为向各位揭示它究竟有多么惊人！
>
> 翻开第一章几页内容，你就能掌握如何用四行代码、不到一分钟的计算时间，构建出能区分猫狗的尖端神经网络。接着进入第二章，它将带你从模型到生产环境，展示如何无需HTML或JavaScript、无需拥有服务器，就能快速部署网络应用。
>
> 我将此书比作洋葱。它提供最佳配置的完整解决方案，若需调整，可剥去外层；若需更精细的调校，可继续剥离；若追求极致，甚至能深入到裸用PyTorch的层面。在这部600页的著作中，您将获得三种独立声音的全程指引，它们将为您提供方向与独特视角。
>
> ——Alfredo Canziani，纽约大学计算机科学教授

> 《程深度学习实践指南》是一本通俗易懂的对话式书籍，采用全局视角讲解深度学习概念。本书注重让读者从一开始就通过真实案例动手实践，仅在必要时引入相关概念。实践者可通过前半部分的动手实例进入本书的深度学习世界，而当他们穿越后半部分时，会自然接触到更深层的概念，所有有害的误区都将被彻底揭穿。
>
> ——Josh Patterson，帕特森咨询公司

## 真正的前言

深度学习是一项强大的新技术，我们认为它应在众多学科领域得到广泛应用。领域专家最有可能发掘其新应用场景，我们需要更多来自不同背景的人士参与其中并开始运用这项技术。

正因如此，杰里米联合创立了fast.ai，他希望通过免费在线课程和软件让深度学习更易上手。西尔万是Hugging Face的研究工程师。此前他曾在fast.ai担任研究科学家，并曾在为学生准备进入法国精英大学的项目中担任数学和计算机科学教师。我们共同撰写本书，希望将深度学习带给尽可能多的人。

### 谁适合这本书？

如果你是深度学习和机器学习的完全新手，这里非常欢迎你。我们唯一的期望是你已经掌握编程技能，最好是Python语言。

> 没有经验？完全没问题！
>
> 即使你没有任何编程经验也完全没问题！前三章的内容专门为高管、产品经理等群体精心编写，旨在帮助他们掌握深度学习领域最关键的核心知识。当你在文本中看到代码片段时，请尝试浏览它们，以获得对代码功能的直观理解。我们将逐行解析这些代码。语法细节远不如对整体运作机制的高层级理解重要。

如果你已是深具自信的深度学习实践者，本书同样能为你提供诸多启发。我们将向你展示如何取得世界级的成果，包括运用最新研究成果的技术。正如我们将要阐明的，这并不需要高深的数学训练或多年的钻研，你只需要一点点常识和坚韧不拔的毅力。

### 你需要知道些什么？

正如我们之前所说，唯一的先决条件是你懂得编程（一年经验就足够了），最好是掌握Python语言，并且至少完成过高中数学课程的学习。即使你现在记忆模糊也没关系，我们会根据需要进行复习。[Khan Academy](https://www.khanacademy.org/) 提供了丰富的免费在线资源，能为你提供帮助。

我们并不是说深度学习不涉及高中以上的数学知识，但在讲解需要这些知识的主题时，我们会教你所需的基础知识（或引导你获取相关学习资源）。

本书从宏观视角切入，逐步深入细节，因此你可能需要时不时地放下书本，去学习一些补充知识（某种编程方法或数学知识点）。这完全没问题，这正是我们希望读者阅读本书的方式。开始阅读吧，你可以仅在需要时才去查阅补充资源。

请注意，Kindle或其他电子阅读器用户可能需要双击图片才能查看完整尺寸版本。

> 线上资源
>
> 本书中展示的所有代码示例均以Jupyter笔记本的形式在线提供（别担心，您将在第1章中全面了解Jupyter是什么）。这是本书的交互式版本，您可实际执行代码并进行实验。更多详情请访问 [本书网站](https://book.fast.ai/)。该网站还提供各类工具的最新配置指南及若干额外赠章。

### 你将会学到什么？

在你读完这本书之后，你将会知道以下内容：

- 如何训练模型以在以下特定领域实现最先进的结果：
  - 计算机视觉，包括图像分类（例如按品种分类宠物照片）以及图像定位与检测（例如在图像中寻找动物）
  - 自然语言处理（NLP），包括文档分类（例如电影评论、情感分析）和语言建模
  - 表格数据（如销售预测），包含分类变量、连续变量及混合变量，并涵盖时间序列数据。
  - 协同过滤（例如电影推荐）
- 如何将模型转化为web应用程序
- 深度学习模型的工作原理及其应用方法，以及如何利用这些知识提升模型的准确性、速度和可靠性
- 在实践中学会真正重要的最新深度学习技术
- 如何阅读深度学习研究论文
- 如何从零开始实现深度学习算法
- 如何思考工作的伦理影响，以确保你正在让世界变得更美好，且你的工作不会被滥用于危害他人

请参阅目录获取完整列表，但为了让你先睹为快，以下是部分涵盖的技术（不必担心这些术语目前对你来说可能毫无意义——你很快就会掌握它们）：

- 仿射函数与非线性函数
- 参数与激活函数
- 随机初始化与迁移学习
- SGD、动量、Adam及其他优化器
- 卷积操作
- 批量归一化
- Dropout（随机失活）
- 数据增强
- 权重衰减
- ResNet与DenseNet架构
- 图像分类与回归
- 嵌入表示
- 循环神经网络（RNNs）
- 分割技术
- U-Net架构
- 以及更多内容！

> 章节问卷
>
> 如果你翻到每章结尾，会发现一份问卷。这是回顾章节内容的好地方——因为（我们希望！）读完每章后，你都能回答所有问题。事实上，有位审阅者（感谢弗雷德！）表示他喜欢先阅读问卷，再研读章节内容，这样就能明确重点关注方向。

### O’Reilly 的线上学习资源

> 注记
>
> 四十余年来，[O'Reilly Media](http://oreilly.com/) 始终致力于提供技术与商业培训、知识及洞见，助力企业取得成功。

我们独特的专家与创新者网络通过书籍、文章及在线学习平台分享知识与专业技能。O'Reilly在线学习平台为你提供按需访问的实时培训课程、深度学习路径、交互式编码环境，以及来自O'Reilly和200多家出版商的海量文本与视频资源。了解更多信息，请访问：http://oreilly.com。

### 如何与我们取得联系

关于本书的任何意见和疑问，请联系出版社：

O’Reilly Media, Inc.
1005 Gravenstein Highway North
Sebastopol, CA 95472
800-998-9938 (in the United States or Canada)
707-829-0515 (international or local)
707-829-0104 (fax)

我们为本书开设了网页，其中列出了勘误表、示例及任何补充信息。你可通过以下网址访问该页面：https://oreil.ly/deep-learning-for-coders。

请发送邮件至 bookquestions@oreilly.com 发表评论或咨询本书的技术问题。

有关我们的书籍和课程的最新资讯，请访问：http://oreilly.com。

在Facebook上关注我们：http://facebook.com/oreilly

在Twitter上关注我们：http://twitter.com/oreillymedia

在YouTube上观看我们的视频：http://www.youtube.com/oreillymedia

## 推荐序

在极短的时间内，深度学习已成为一项广泛实用的技术，在计算机视觉、机器人学、医疗保健、物理学、生物学等众多领域实现了问题的解决与自动化。深度学习令人欣喜之处在于其相对的简洁性。强大的深度学习软件已然建成，让入门变得快速而轻松。短短数周内，你就能掌握基础知识，并熟练运用相关技术。

这开启了一个充满创造力的世界。当你开始将它应用于手头有数据的问题时，看着机器为你解决难题，那种感觉美妙极了。然而，你渐渐意识到自己正逼近一道高墙——你构建的深度学习模型效果远不及预期。此时你便迈入了下一阶段：寻找并研读深度学习领域的尖端研究成果。

然而，深度学习领域存在着庞大的知识体系，背后支撑着三十年的理论、技术与工具发展。当你研读相关研究时，会发现人类往往用极其复杂的方式解释简单事物。科学家在论文中使用的术语和数学符号显得晦涩难懂，而现有的教科书或博客文章似乎都未能以通俗易懂的方式阐述所需的基础知识。工程师和程序员往往默认读者已经了解GPU的工作原理，并掌握各种冷门工具的使用方法。

此刻你一定会渴望有个导师或知己可倾诉。一个曾与你处境相同、精通工具与数学的人——能引领你探索顶尖研究、前沿技术与高级工程，并将复杂知识化繁为简。十年前我正站在你的位置初涉机器学习领域。多年间，我苦苦挣扎于那些略带数学内容的论文。身边虽有良师益友相助，却仍耗费多年才真正驾驭机器学习与深度学习。这段经历促使我共同创建PyTorch——这个让深度学习触手可及的软件框架。

杰里米·霍华德和西尔万·古格也曾与你处境相同。他们渴望学习并应用深度学习技术，却未曾接受过机器学习科学家或工程师的正规训练。与我相似，杰里米和西尔万历经数年逐步精进，最终成为该领域的专家与领军人物。但不同于我的是，杰里米和西尔万无私地投入了大量精力，确保他人不必重蹈他们走过的艰辛之路。他们创建了名为fast.ai的卓越课程，让掌握基础编程的人也能接触前沿深度学习技术。该课程已培养出数十万名热忱的学习者，他们如今都已成为杰出的实践者。

在这本不懈创作的著作中，杰里米与西尔万构建了一场穿越深度学习的奇幻之旅。他们运用简明语言阐释每个概念，将前沿的深度学习技术与尖端研究成果呈现于读者眼前，却又使其通俗易懂。

你将跟随本书畅游计算机视觉的最新进展，深入自然语言处理领域，并在500页的精彩旅程中掌握基础数学知识。这趟旅程不仅充满乐趣，更将引领你将创意转化为实际产品。快快加入fast.ai社区吧——这里汇聚了数千名在线实践者，宛如你的家人一样。无论遇到何种难题，总有志同道合的伙伴与你畅谈，共同构思大大小小的解决方案。

我很高兴你发现了这本书，希望它能激励你将深度学习用于善举，无论问题本质如何。

——Soumith Chintala，PyTorch 联合创始人